<hr />
<p>This program generates optimal search schemes of the following paper<br />
&quot;Optimum Search Schemes for Approximate String Matching Using Bidirectional FM-Index&quot;.<br />
This program meant to be used for generating the results of above paper and is not for commercial use.</p>
<hr />
<p>The MIP could have different solutions with same objective values. It is possible multiple runs of one problem, which did not reach the optimality (rum time equals to run time limit), would result in slightly different solutions and objective values.</p>
<h2 id="there-are-two-options-to-run-the-program-in-linux">There are two options to run the program in Linux:</h2>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash">   $ <span class="fu">git</span> clone https://github.com/kianfar77/OptimumSearchSchemes.git
   $ <span class="bu">cd</span> OptimumSearchSchemes/MIPCode/</code></pre></div>
<h3 id="run-the-executive-file">Run the executive file</h3>
<ul>
<li>Before running the program, make sure there is a folder named &quot;output&quot; in application directory.</li>
<li>Do not delete or modify parameters.txt</li>
<li>In application directory, type the following commands in terminal</li>
</ul>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash">   $ <span class="fu">chmod</span> +x EqualFix
   $ <span class="ex">./EqualFix</span> -s <span class="op">&lt;</span>upperbound on number of searches<span class="op">&gt;</span> -p <span class="op">&lt;</span>number of parts<span class="op">&gt;</span> -k <span class="op">&lt;</span>maximum error<span class="op">&gt;</span> -r <span class="op">&lt;</span>read length<span class="op">&gt;</span> [-t <span class="op">&lt;</span>time limit<span class="op">&gt;</span>][--lowerK= <span class="op">&lt;</span>minimum number of errors<span class="op">&gt;</span>][--lp][--verbose][--sigma][-h<span class="kw">|</span><span class="ex">--help</span>]</code></pre></div>
<h3 id="build-from-source-code">Build from source code</h3>
<ul>
<li>Make sure you have the following files in &quot;libs&quot; folder (you can acquire the latest version on <a href="https://developer.ibm.com/docloud/blog/2016/11/24/cos-12-7-ai/" title="IBM">IBM download page for students/faculties</a>, see the section &quot;required libraries&quot; in this manual)</li>
</ul>
<ol style="list-style-type: decimal">
<li>cplex.h</li>
<li>cpxconst.h</li>
<li>libcplex.a</li>
<li>libilocplex.a</li>
<li>libcplexdistmip.a</li>
</ol>
<ul>
<li>Before running the program, make sure there is a folder named &quot;output&quot; in source directory.</li>
<li>In source files' directory, type the following commands in terminal</li>
</ul>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash">   $ <span class="fu">make</span>
   $ <span class="ex">./EqualFix</span> -s <span class="op">&lt;</span>upperbound on number of searches<span class="op">&gt;</span> -p <span class="op">&lt;</span>number of parts<span class="op">&gt;</span> -k <span class="op">&lt;</span>maximum error<span class="op">&gt;</span> -r <span class="op">&lt;</span>read length<span class="op">&gt;</span> [-t <span class="op">&lt;</span>time limit<span class="op">&gt;</span>][--lowerK= <span class="op">&lt;</span>minimum number of errors<span class="op">&gt;</span>][--lp][--verbose][--sigma][-h<span class="kw">|</span><span class="ex">--help</span>]</code></pre></div>
<h2 id="arguments-of-the-program">Arguments of the program:</h2>
<table>
<colgroup>
<col width="11%" />
<col width="88%" />
</colgroup>
<tbody>
<tr class="odd">
<td>-s:</td>
<td>Upperbound on the number of searches. [required]</td>
</tr>
<tr class="even">
<td>-p:</td>
<td>Number of parts (partitions). [required]</td>
</tr>
<tr class="odd">
<td>-k:</td>
<td>Number of maximum errors. [required]</td>
</tr>
<tr class="even">
<td>-r:</td>
<td>Length of read. [required]</td>
</tr>
<tr class="odd">
<td>-t:</td>
<td>Upperbound on run time. [optional, defualt= 3.0 hours]</td>
</tr>
<tr class="even">
<td>--lowerK:</td>
<td>Number of minimum errors. [optional, defualt= 0 ]</td>
</tr>
<tr class="odd">
<td>--lp:</td>
<td>Prints out the MIP formulation. [optional]</td>
</tr>
<tr class="even">
<td>--verbose:</td>
<td>Prints out the progress of objective value, rows starting with * correspond to integer feasible solutions. [optional]</td>
</tr>
<tr class="odd">
<td>--sigma:</td>
<td>Alphabet size. [optional, defualt= 4 ]</td>
</tr>
<tr class="even">
<td>-h, --help:</td>
<td>Displays help.</td>
</tr>
</tbody>
</table>
<h3 id="usage">Usage</h3>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash">   $ <span class="ex">./EqualFix</span> --help
   $ <span class="ex">./EqualFix</span> -s 3 -p 3 -k 2 -r 12
   $ <span class="ex">./EqualFix</span> -s 3 -p 3 -k 2 -r 12 -t 0.5
   $ <span class="ex">./EqualFix</span> -s 3 -p 3 -k 2 -r 12 -t 0.5 --verbose --lowerK=1 --sigma=2
   $ <span class="ex">./EqualFix</span> -s 3 -p 3 -k 2 -r 12 -t 0.5 --verbose --lp <span class="op">&gt;</span> ./output/verbose.txt</code></pre></div>
<h2 id="output">Output:</h2>
<ul>
<li>The objective value and execution time (only for solver) will be printed on the screen.</li>
<li>The program generates &quot;output.txt&quot; in &quot;output&quot; folder.</li>
<li>&quot;output.txt&quot; contains sigma (alphabet size), S (upper bound on number of searches), P (number of parts), lowerK (minimum number of errors), K (maximum number of errors), R (read length), run time (sec), and Objective (number of edges in all tries). Also for each search, there are U's (upper bounds on errors in different parts), x's (the order in which a search processes the parts), and L's (lower bounds on errors in different read's parts). There would be P elements in x's , L's and U's. First element of x shows the partition (part) being searched at iteration 1, second element of x shows the partition covered at iteration 2, and so forth. Similarly for L and U, the ith elements represent the number of errors in the ith element of x, the part of the read, processed at ith iteration. In other words, the ith elements of x, L, and U are associated with iteration i.</li>
<li>The program generates &quot;LP.lp&quot; in &quot;output&quot; folder if --lp is recieved. &quot;LP.lp&quot; contains the mixed integer program.</li>
<li>If detailed verbose is requested, The progress of feasible solutions toward the optimal solution will be printed on the screen (results in a longer run time). In order to save detailed verbose messages you may run the program by typing ./EqualFix -s <upperbound on number of searches> -p <number of parts> -k <maximum error> -r <read length> &gt; ./output/verbose.txt. In detailed verbose setting, rows starting with &quot;*&quot; represent a feasible integer solution. By looking at those rows one can observe how fast the program converges to the optimal solution (see verboseExample.png).</li>
</ul>
<h3 id="output_for_some_optimal_runs.txt">output_for_some_optimal_runs.txt</h3>
<p>This file contains the optimal search schemes for some instances we had run for the paper. Please notice that there might be some empty searches in which upper bound on errors is greater than lower bound on errors for some parts.</p>
<h3 id="parameters_used_for_runs.txt">parameters_used_for_runs.txt</h3>
<p>This file contains the input parameters that we had used for generating graphs and tables in the paper.</p>
<h2 id="required-libraries">Required libraries</h2>
<ul>
<li>CPLEX 12.7.1 was used for the paper</li>
<li>You may access to the latest version (12.8) on <a href="https://developer.ibm.com/docloud/blog/2016/11/24/cos-12-7-ai/" title="IBM">IBM download page for students/faculties</a></li>
<li>Install CPLEX under super user</li>
</ul>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash">   $ <span class="fu">chmod</span> +x cplex_file_you_have_downloaded.bin
   $ <span class="ex">./cplex_file_you_have_downloaded.bin</span></code></pre></div>
<ul>
<li>For an arbitrary instalation path such as /opt/ibm/ILOG/CPLEX_Studio1271,
<ul>
<li>cplex.h and cpxconst.h would be located at<br />
/opt/ibm/ILOG/CPLEX_Studio1271/cplex/include/ilcplex</li>
<li>libcplex.a, libilocplex.a, and libcplexdistmip.a would be located at<br />
/opt/ibm/ILOG/CPLEX_Studio1271/cplex/lib/x86-64_linux/static_pic/</li>
</ul></li>
</ul>
